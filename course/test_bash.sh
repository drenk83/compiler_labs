#!/bin/bash

# -------------------------------------------------
# Пример скрипта, демонстрирующего базовые возможности Bash
# Название: demo.sh
# -------------------------------------------------

# 1. Комментарии — всё после # игнорируется

# 2. Переменные
name="Алиса"
age=30
readonly PI=3.1415  # константа (только для чтения)
your_name="$USER"  # используем текущего пользователя, если не задано иное

# 3. Вывод на экран
echo "Привет, $name! Тебе $age лет."
echo "Число Пи ≈ $PI"

# 4. Условия (if-else)
if [ "$age" -ge 18 ]; then
    echo "$name совершеннолетняя."
elif [ "$age" -gt 0 ]; then
    echo "$name несовершеннолетняя."
else
    echo "Возраст некорректен."
fi

# 5. Case-выбор
read -p "Введите команду (start|stop|restart): " action

case $action in
    start)
        echo "Запускаем сервис..."
        ;;
    stop)
        echo "Останавливаем сервис..."
        ;;
    restart)
        echo "Перезапускаем сервис..."
        ;;
    *)
        echo "Неизвестная команда. Используйте: start, stop или restart."
        ;;
esac

# 6. Циклы

# Цикл for по диапазону
echo "Считаем до 3:"
for i in {1..3}; do
    echo "  $i"
done

# Цикл while
counter=0
while [ $counter -lt 2 ]; do
    echo "  while: итерация $((counter + 1))"
    ((counter++))
done

# 7. Массивы
fruits=("яблоко" "банан" "апельсин")
echo "Фрукты: ${fruits[0]}, ${fruits[1]}, ${fruits[2]}"
echo "Всего фруктов: ${#fruits[@]}"

# Вывод всех элементов массива
echo "Все фрукты: ${fruits[*]}"

# 8. Функции
greet() {
    local user="$1"  # локальная переменная
    echo "Привет из функции, $user!"
}
greet "$your_name"

# 9. Арифметика
result=$(( 10 + 5 * 2 ))
echo "10 + 5 * 2 = $result"

# 10. Проверка существования файла
if [ -f "./demo.sh" ]; then
    echo "Файл demo.sh существует."
else
    echo "Файл demo.sh не найден (возможно, запущен из другого каталога)."
fi

# 11. Проверка директории
if [ -d "/tmp" ]; then
    echo "Директория /tmp существует."
fi

# 12. Выход со статусом
echo "Скрипт завершён успешно."
exit 0